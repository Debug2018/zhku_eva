(function(t){function e(e){for(var i,o,n=e[0],r=e[1],c=e[2],d=0,u=[];d<n.length;d++)o=n[d],l[o]&&u.push(l[o][0]),l[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);h&&h(e);while(u.length)u.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,n=1;n<a.length;n++){var r=a[n];0!==l[r]&&(i=!1)}i&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var i={},l={app:0},s=[];function o(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=i,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(a,i,function(e){return t[e]}.bind(null,i));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/zhku_eva/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],r=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var h=r;s.push([1,"chunk-vendors"]),a()})({0:function(t,e){},"034f":function(t,e,a){"use strict";var i=a("64a9"),l=a.n(i);l.a},1:function(t,e,a){t.exports=a("56d7")},"19f7":function(t,e,a){},2:function(t,e){},3:function(t,e){},"3d49":function(t,e,a){"use strict";var i=a("c545"),l=a.n(i);l.a},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("el-container",[a("el-header",[a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleNavigation}},[a("el-menu-item",{attrs:{index:"1"}},[t._v("首页")]),a("el-menu-item",{attrs:{index:"2"}},[t._v("合并Excel表格&排序")]),a("el-menu-item",{attrs:{index:"3"}},[t._v("综测自动评判")]),a("el-menu-item",{attrs:{index:"4"}},[t._v("详细使用文档")]),a("el-menu-item",{attrs:{index:"5"}},[t._v("综合测评管理办法")])],1)],1),a("el-main",[a("router-view")],1)],1)],1)},s=[],o={name:"app",data:function(){return{activeIndex:"1"}},methods:{handleNavigation:function(t,e){switch(console.log(t),t){case"1":this.activeIndex="1",this.$router.push("/");break;case"2":this.activeIndex="2",this.$router.push("/m");break;case"3":this.activeIndex="3",this.$router.push("/s");break;case"4":this.activeIndex="4",window.open("https://chenaey.github.io/zhku/","_blank");case"5":this.activeIndex="5",window.open("http://imgs.91ans.com/%E4%BB%B2%E5%AD%A6%E5%AD%97%E3%80%942013%E3%80%9522%E5%8F%B7%EF%BC%8C%E5%85%B3%E4%BA%8E%E5%8D%B0%E5%8F%91%E3%80%8A%E4%BB%B2%E6%81%BA%E5%86%9C%E4%B8%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6%E9%99%A2%E5%AD%A6%E7%94%9F%E7%BB%BC%E5%90%88%E6%B5%8B%E8%AF%84%E7%AE%A1%E7%90%86%E5%8A%9E%E6%B3%95%E3%80%8B%E7%9A%84%E9%80%9A%E7%9F%A5.pdf","_blank");default:break}}}},n=o,r=(a("034f"),a("2877")),c=Object(r["a"])(n,l,s,!1,null,null,null),h=c.exports,d=a("8c4f"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("el-container",[a("el-aside",{staticClass:"aside",staticStyle:{"margin-right":"-20px","border-right":"2px solid #f7f7f7"},attrs:{width:"310px",height:"2000px"}},[a("div",{staticClass:"my-table"},[a("div",{staticClass:"my-col-left"},[a("div",{staticClass:"my-col"},[a("p",{attrs:{id:"info-col-title"}},[t._v("表格信息")]),a("div",{staticClass:"my-row"},[a("p",{attrs:{id:"info-left-text"}},[t._v("总人数/人")]),a("div",{attrs:{id:"info-right-text"}},[t._v(t._s(t.allStuNum))])])])])])]),a("el-main",[a("div",{staticClass:"top"},[a("div",{staticClass:"my-table"},[a("div",{staticClass:"my-col-left",staticStyle:{width:"320px"}},[a("div",{staticClass:"my-col"},[a("p",{attrs:{id:"info-col-title"}},[t._v("已合并排序文件")]),t._l(t.finishFileList,function(e,i){return a("div",{key:i,staticClass:"my-row"},[a("p",{attrs:{id:"info-left-text"}},[t._v(t._s(e.name))]),a("el-button",{attrs:{type:"primary",icon:"el-icon-download",id:"info-right-text-icon"},on:{click:function(a){return t.handleExpore(e,i)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",id:"info-right-text-icon"},on:{click:function(a){return t.handleRemoveFinishFileList(e,i)}}})],1)})],2)])]),a("div",{staticClass:"my-table"},[a("div",{staticClass:"my-col-left",staticStyle:{width:"320px"}},[a("div",{staticClass:"my-col"},[a("p",{attrs:{id:"info-col-title"}},[t._v("已导入文件")]),t._l(t.fileList,function(e,i){return a("div",{key:i,staticClass:"my-row"},[a("p",{attrs:{id:"info-left-text"}},[t._v(t._s(e.name))]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",id:"info-right-text-icon"},on:{click:function(a){return t.handleRemove(e,i)}}})],1)})],2)])]),a("div",{staticClass:"my-table"},[a("div",{staticClass:"my-col-left",staticStyle:{width:"370px"}},[a("div",{staticClass:"my-col"},[a("p",{staticStyle:{width:"360px"},attrs:{id:"info-col-title"}},[t._v("导入文件")]),a("el-upload",{staticClass:"upload",attrs:{"show-file-list":!1,drag:"",action:"","auto-upload":!1,multiple:"","on-change":t.importExcel}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("\n                  将文件拖到此处，或\n                  "),a("em",[t._v("点击导入")])])])],1)])])]),a("div",{staticClass:"operator"},[a("div",{staticClass:"my-row"},[a("el-select",{staticStyle:{"padding-right":"10px"},attrs:{size:"mini",placeholder:"请选择"},model:{value:t.showWhich,callback:function(e){t.showWhich=e},expression:"showWhich"}},t._l(t.finishFileList,function(t,e){return a("el-option",{key:t.name,attrs:{label:t.name,value:e}})}),1),a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"success",size:"mini"},on:{click:t.mergeExcel}},[t._v("合并&排序已导入文件")])],1)]),a("el-table",{staticStyle:{width:"100%","margin-bottom":"60px"},attrs:{data:t.showTableData,border:"","highlight-current-row":"","header-align":"center",stripe:"",size:"mini",height:"600"}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{fixed:"",type:"index",index:t.indexMethod,label:"#",width:"45"}}),a("el-table-column",{attrs:{fixed:"",prop:"姓名",label:"姓名",width:"60"}}),a("el-table-column",{attrs:{fixed:"",sortable:"",prop:"学工号",label:"学号",width:"110"}}),a("el-table-column",{attrs:{prop:"专业班级",label:"专业班级",width:"70"}}),a("el-table-column",{attrs:{prop:"是否干部",label:"是否干部",width:"70"}}),a("el-table-column",{attrs:{prop:"学业分",label:"学业分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"学业分排名",label:"排名",width:"70"}}),a("el-table-column",{attrs:{prop:"思想分",label:"思想分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"思想分排名",label:"排名",width:"70"}}),a("el-table-column",{attrs:{prop:"文体分",label:"文体分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"文体分排名",label:"排名",width:"70"}}),a("el-table-column",{attrs:{prop:"综合分",label:"综合分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"综合分专业年级排名",label:"年级排名",width:"70"}}),a("el-table-column",{attrs:{prop:"评优类别",label:"评优类别",width:"75"}}),a("el-table-column",{attrs:{align:"right",width:"100"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"搜索"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]}}])})],1)],1)],1)],1)},f=[],p=(a("ac6a"),a("456d"),a("a481"),a("28a5"),a("4917"),a("7f7f"),a("55dd"),a("6762"),a("2fdb"),a("44a0"),a("22c8")),v=a.n(p),b={name:"selectGood",beforeCreate:function(){},watch:{fileList:function(){for(var t=this.fileList,e=0,a=0;a<t.length;a++)e+=t[a].data.length;this.allStuNum=e,this.good_student_bb=Math.round(.01*e),console.log("fileList has change"),this.fileList.length<=0&&(this.showWhich=-1)},showWhich:function(){console.log(this.showWhich),this.finishFileList.length>0&&this.showWhich>=0&&(this.tableData=this.finishFileList[this.showWhich].data,this.showTableData=this.finishFileList[this.showWhich].data)},search:function(t){this.showTableData=this.tableData.filter(function(e){return e["姓名"].includes(t)||e["学工号"].includes(t)||e["专业班级"].includes(t)})}},methods:{handleRemove:function(t,e){this.fileList.splice(e,1)},handleRemoveFinishFileList:function(t,e){this.finishFileList.splice(e,1)},handleExpore:function(t,e){var a=this.finishFileList[e];this.exportExcel(a)},mergeExcel:function(){var t=this.fileList;console.log(t);for(var e=[],a=0;a<t.length;a++)e=e.concat(t[a].data);e.sort(function(t,e){return e["学业分"]-t["学业分"]});for(var i=0;i<e.length;i++)if(0===i)e[i]["学业分排名"]=i+1;else{var l=e[i-1]["学业分"];e[i]["学业分"]===l?e[i]["学业分排名"]=e[i-1]["学业分排名"]:e[i]["学业分排名"]=i+1}e.sort(function(t,e){return e["思想分"]-t["思想分"]});for(var s=0;s<e.length;s++)if(0===s)e[s]["思想分排名"]=s+1;else{l=e[s-1]["思想分"];e[s]["思想分"]===l?e[s]["思想分排名"]=e[s-1]["思想分排名"]:e[s]["思想分排名"]=s+1}e.sort(function(t,e){return e["文体分"]-t["文体分"]});for(var o=0;o<e.length;o++)if(0===o)e[o]["文体分排名"]=o+1;else{l=e[o-1]["文体分"];e[o]["文体分"]===l?e[o]["文体分排名"]=e[o-1]["文体分排名"]:e[o]["文体分排名"]=o+1}e.sort(function(t,e){return e["综合分"]-t["综合分"]});for(var n=0;n<e.length;n++)if(0===n)e[n]["综合分专业年级排名"]=n+1;else{l=e[n-1]["综合分"];e[n]["综合分"]===l?e[n]["综合分专业年级排名"]=e[n-1]["综合分专业年级排名"]:e[n]["综合分专业年级排名"]=n+1}var r=this.fileList[0].name,c=r.match(/\d{3}/)[0].slice(2,3),h=r.split("").reverse().join(""),d=h.replace(c,"级").split("").reverse().join(""),u={name:d,data:e};console.log(u),this.finishFileList.push(u),console.log(this.finishFileList),this.exportExcel(u)},importExcel:function(t,e){var a=this,i=new FileReader;i.onload=function(e){try{var i=e.target.result,l=v.a.read(i,{type:"binary"}),s=Object.keys(l.Sheets)[0],o=v.a.utils.sheet_to_json(l.Sheets[s]);console.log(o),a.fileList.push({name:t.name,data:o})}catch(n){console.log(n)}},i.readAsBinaryString(t.raw)},exportExcelH:function(){console.log(this.fileList.length);for(var t=v.a.utils.book_new(),e=[],a=0;a<this.fileList.length;a++){var i=this.fileList[a].data.filter(function(t){return"三好学生标兵"===t["评优类别"]||"三好学生"===t["评优类别"]||"学习积极分子"===t["评优类别"]||"文体积极分子"===t["评优类别"]||"优秀学生干部"===t["评优类别"]});e=e.concat(i)}console.log(e),e=e.map(function(t){return{"姓名":t["姓名"],"学院":t["学院"],"学号":t["学工号"],"专业":t["专业班级"].replace(/\d{3,4}/,""),"年级":t["入学年度"],"评优类别":t["评优类别"],"身份证号码":t["身份证号码"],"手机号码":t["手机号码"]}}),console.log(e);var l=v.a.utils.json_to_sheet(e);v.a.utils.book_append_sheet(t,l,"sheet"),v.a.writeFile(t,"附件2：优秀学生单项积极分子名单汇总表.xlsx")},exportExcel:function(t){console.log(this.finishFileList.length);var e=t.name,a=t.data;this.filename=e;var i=v.a.utils.book_new(),l=v.a.utils.json_to_sheet(a);v.a.utils.book_append_sheet(i,l,"sheet"),v.a.writeFile(i,e),this.filename="请输入导入文件名称"},indexMethod:function(t){return t+1},handleSearch:function(){console.log("S")}},data:function(){return{gridData:[],allStuNum:0,showWhich:void 0,showTableData:[],tableData:[],fileList:[],finishFileList:[],search:void 0,filename:"请输入导出文件名字"}}},m=b,g=(a("3d49"),Object(r["a"])(m,u,f,!1,null,"d86e94b0",null)),_=g.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("el-container",[a("el-aside",{staticStyle:{"margin-right":"-20px","border-right":"2px solid #f7f7f7"},attrs:{width:"280px;"}},[a("div",{staticClass:"my-table"},[a("div",{staticClass:"my-col-left"},[a("div",{staticClass:"my-col"},[a("p",{attrs:{id:"info-col-title"}},[t._v("综合测评配置")]),a("div",{staticClass:"my-row"},[a("div",{attrs:{id:"info-left-text"}},[t._v("学院总人数")]),a("div",{attrs:{id:"info-right-text"}},[t._v(t._s(t.allStuNum))])]),a("div",{staticClass:"my-row"},[a("div",{attrs:{id:"info-left-text"}},[t._v("三好学生标兵")]),a("div",{attrs:{id:"info-right-text"}},[t._v(t._s(t.good_student_bb))])]),t._l(t.fileList,function(e,i){return a("div",{key:i},[a("p",{staticStyle:{"background-color":"#8cc540"},attrs:{id:"info-col-title"}},[t._v(t._s(e.name.replace(".xlsx","").replace(".xls",""))+" 应评选人数")]),a("div",{staticClass:"my-row"},[a("div",{attrs:{id:"info-left-text"}},[t._v("三好学生")]),a("div",{attrs:{id:"info-right-text"}},[t._v(t._s(e.good_student))])]),a("div",{staticClass:"my-row"},[a("div",{attrs:{id:"info-left-text"}},[t._v("单项积极分子")]),a("div",{attrs:{id:"info-right-text"}},[t._v(t._s(e.good_activate))])])])})],2)])])]),a("el-main",{staticStyle:{"margin-right":"-26px"}},[a("div",{staticClass:"top"},[a("div",{staticClass:"my-table"},[a("div",{staticClass:"my-col-left",staticStyle:{width:"370px"}},[a("div",{staticClass:"my-col"},[a("p",{attrs:{id:"info-col-title"}},[t._v("已导入文件")]),t._l(t.fileList,function(e,i){return a("div",{key:i,staticClass:"my-row"},[a("div",{attrs:{id:"info-left-text"}},[t._v(t._s(e.name))]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",id:"info-right-text-icon"},on:{click:function(a){return t.handleRemove(e,i)}}})],1)})],2)])]),a("div",{staticClass:"my-table"},[a("div",{staticClass:"my-col-left",staticStyle:{width:"370px"}},[a("div",{staticClass:"my-col"},[a("p",{staticStyle:{width:"360px"},attrs:{id:"info-col-title"}},[t._v("导入文件")]),a("el-upload",{staticClass:"upload",attrs:{"show-file-list":!1,drag:"",action:"","auto-upload":!1,multiple:"","on-change":t.importExcel}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("\n                  将文件拖到此处，或\n                  "),a("em",[t._v("点击导入")])])])],1)])])]),a("div",{staticClass:"operator"},[a("div",{staticClass:"my-row"},[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"success",size:"mini"},on:{click:t.chooseGooodStu}},[t._v("一键评选")]),a("el-input",{staticStyle:{width:"242px","padding-left":"10px","padding-right":"10px","margin-bottom":"10px"},attrs:{size:"mini",placeholder:"输入文件名，默认为原文件名"},model:{value:t.filename,callback:function(e){t.filename=e},expression:"filename"}}),a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"success",size:"mini"},on:{click:t.exportExcel}},[t._v("导出文件")]),a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"success",size:"mini"},on:{click:t.exportExcelH}},[t._v("导出名单汇总文件")])],1),a("div",{staticClass:"my-row"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.showWhich,callback:function(e){t.showWhich=e},expression:"showWhich"}},t._l(t.fileList,function(t,e){return a("el-option",{key:t.name,attrs:{label:t.name,value:e}})}),1),a("div",[a("el-button",{attrs:{size:"mini","data-id":"0"},on:{click:function(e){return t.showWhat(1)}}},[t._v("显示全部"+t._s(t.tableData.length))]),a("el-button",{attrs:{size:"mini","data-id":"1"},on:{click:function(e){return t.showWhat(2)}}},[t._v("优秀学生")]),a("el-button",{attrs:{size:"mini","data-id":"2"},on:{click:function(e){return t.showWhat(8)}}},[t._v("三好学生标兵")]),a("el-button",{attrs:{size:"mini","data-id":"2"},on:{click:function(e){return t.showWhat(3)}}},[t._v("三好学生")]),a("el-button",{attrs:{size:"mini","data-id":"3"},on:{click:function(e){return t.showWhat(4)}}},[t._v("单项积极分子")]),a("el-button",{attrs:{size:"mini","data-id":"4"},on:{click:function(e){return t.showWhat(5)}}},[t._v("优秀学生干部")]),a("el-button",{attrs:{size:"mini","data-id":"5"},on:{click:function(e){return t.showWhat(6)}}},[t._v("学习积极分子")]),a("el-button",{attrs:{size:"mini","data-id":"6"},on:{click:function(e){return t.showWhat(7)}}},[t._v("文体积极分子")])],1)],1)]),a("div",{staticStyle:{"margin-left":"10px","margin-bottom":"10px"}},[t.showSelect?a("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:t.makeSure}},[t._v("请在下面构选正确的三好学生标兵人选后 点我确定选择")]):t._e()],1),a("el-table",{staticStyle:{width:"100%","margin-bottom":"60px"},attrs:{data:t.showTableData,border:"","highlight-current-row":"","header-align":"center",stripe:"",size:"mini",height:"600"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{fixed:"",type:"index",index:t.indexMethod,label:"#",width:"45"}}),a("el-table-column",{attrs:{fixed:"",prop:"姓名",label:"姓名",width:"60"}}),a("el-table-column",{attrs:{fixed:"",sortable:"",prop:"学号",label:"学号",width:"100"}}),a("el-table-column",{attrs:{prop:"专业班级",label:"专业班级",width:"70"}}),a("el-table-column",{attrs:{prop:"是否干部",label:"是否干部",width:"50"}}),a("el-table-column",{attrs:{prop:"学业分",label:"学业分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"学业分排名",label:"排名",width:"70"}}),a("el-table-column",{attrs:{prop:"思想分",label:"思想分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"思想分排名",label:"排名",width:"70"}}),a("el-table-column",{attrs:{prop:"文体分",label:"文体分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"文体分排名",label:"排名",width:"70"}}),a("el-table-column",{attrs:{prop:"综合分",label:"综合分",width:"60"}}),a("el-table-column",{attrs:{sortable:"",prop:"综合分专业年级排名",label:"年级排名",width:"70"}}),a("el-table-column",{attrs:{prop:"评优类别",label:"评优类别",width:"75"}}),a("el-table-column",{attrs:{align:"right",width:"100"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"搜索"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"right",width:"500",trigger:"click"}},[a("el-table",{attrs:{data:t.gridData,border:"",align:"center","row-class-name":t.tableRowClassName,"highlight-current-row":"","header-align":"center",stripe:"",size:"mini"}},[a("el-table-column",{attrs:{width:"120",property:"l",label:"名称/排名"}}),a("el-table-column",{attrs:{width:"80",property:"xy",label:"学业分"}}),a("el-table-column",{attrs:{width:"80",property:"sx",label:"思想分"}}),a("el-table-column",{attrs:{width:"80",property:"wt",label:"文体分"}}),a("el-table-column",{attrs:{width:"80",property:"zh",label:"综合分"}})],1),a("el-button",{attrs:{slot:"reference",size:"mini"},on:{click:function(a){return t.handleClick(e.row)}},slot:"reference"},[t._v("查看")])],1)]}}])})],1)],1)],1)],1)},x=[],y={name:"selectGood",beforeCreate:function(){},watch:{fileList:function(){for(var t=this.fileList,e=0,a=0;a<t.length;a++)e+=t[a].data.length;this.allStuNum=e,this.good_student_bb=Math.round(.01*e),console.log("fileList has change"),this.fileList.length<=0&&(this.showWhich=-1)},search:function(t){this.showTableData=this.tableData.filter(function(e){return e["姓名"].includes(t)||e["学号"].includes(t)||e["专业班级"].includes(t)})},showWhich:function(){console.log(this.showWhich),this.fileList.length>0&&this.showWhich>=0&&(this.tableData=this.fileList[this.showWhich].data,this.showTableData=this.fileList[this.showWhich].data)}},methods:{handleRemove:function(t,e){console.log(t,e),this.fileList.splice(e,1)},importExcel:function(t,e){var a=this,i=new FileReader;i.onload=function(e){try{var i=e.target.result,l=v.a.read(i,{type:"binary"}),s=Object.keys(l.Sheets)[0],o=v.a.utils.sheet_to_json(l.Sheets[s]);console.log(o);var n=Math.round(.07*o.length),r=Math.round(.1*o.length),c=0,h=0,d=0,u="";a.fileList.push({name:t.name,data:o,good_student:n,good_activate:r,good_activate_xc:c,good_activate_gb:h,good_activate_wt:d,standard:u})}catch(f){console.log(f)}},i.readAsBinaryString(t.raw)},exportExcelH:function(){console.log(this.fileList.length);for(var t=v.a.utils.book_new(),e=[],a=0;a<this.fileList.length;a++){var i=this.fileList[a].data.filter(function(t){return"三好学生标兵"===t["评优类别"]||"三好学生"===t["评优类别"]||"学习积极分子"===t["评优类别"]||"文体积极分子"===t["评优类别"]||"优秀学生干部"===t["评优类别"]});e=e.concat(i)}console.log(e),e=e.map(function(t){return{"姓名":t["姓名"],"学院":t["学院"],"学号":t["学号"],"专业":t["专业班级"].replace(/\d{3,4}/,""),"年级":t["入学年度"],"评优类别":t["评优类别"],"身份证号码":t["身份证号码"],"手机号码":t["手机号码"]}}),console.log(e);var l=v.a.utils.json_to_sheet(e);v.a.utils.book_append_sheet(t,l,"sheet"),v.a.writeFile(t,"附件2：优秀学生单项积极分子名单汇总表.xlsx")},exportExcel:function(){console.log(this.fileList.length);for(var t=v.a.utils.book_new(),e=0;e<this.fileList.length;e++){var a=v.a.utils.json_to_sheet(this.fileList[e].data),i=this.fileList[e].name.replace(".xlsx","").replace(".xls","");v.a.utils.book_append_sheet(t,a,i)}v.a.writeFile(t,this.filename)},getStandard:function(t){var e=Math.round(.1*t),a=Math.round(.2*t),i=Math.round(.3*t),l=Math.round(.4*t),s=[{l:"三好学生标兵",xy:e,sx:e,wt:a,zh:e},{l:"三好学生",xy:i,sx:i,wt:l,zh:i},{l:"优秀学生干部",xy:"无要求",sx:a,wt:"无要求",zh:i},{l:"学习积极分子",xy:a,sx:"无要求",wt:"无要求",zh:"无要求"},,{l:"文体积极分子",xy:"无要求",sx:"无要求",wt:a,zh:"无要求"}];return s},is_san_bb:function(t,e){var a=Math.round(.1*e),i=Math.round(.2*e),l=(Math.round(.3*e),Math.round(.4*e),t["综合分专业年级排名"]<=a&&t["文体分排名"]<=i&&t["思想分排名"]<=a&&t["学业分排名"]<=a);return l},is_good_student:function(t,e){Math.round(.1*e);var a=Math.round(.2*e),i=Math.round(.3*e),l=Math.round(.4*e);if("是"===t["是否挂科"])return console.log(t["是否挂科"]),-1;if("三好学生标兵"===t["评优类别"])return-1;var s=t["综合分专业年级排名"]<=i&&t["文体分排名"]<=l&&t["思想分排名"]<=i&&t["学业分排名"]<=i;"string"===typeof t["是否干部"]&&(t["是否干部"]=t["是否干部"].trim());var o="是"===t["是否干部"]&&t["综合分专业年级排名"]<=i&&t["思想分排名"]<=a,n=t["学业分排名"]<=a,r=t["文体分排名"]<=a;return s&&o?120:s&&n?121:s&&r?121:s?1:o?20:n?21:r?22:-1},chooseGood_one:function(){for(var t=this,e=this.fileList,a=[],i=this.good_student_bb,l=0;l<e.length;l++)for(var s=e[l].data.length,o=0;o<s;o++){var n=t.is_san_bb(e[l].data[o],s);n&&(console.log(e[l].data[o]["评优类别"]),i--,a.push(e[l].data[o]))}return a.length>this.good_student_bb?{code:-1,result:a}:(console.log("没有问题"),this.fileList=e,this.good_student_bb=i,{code:0,result:a})},handleClick:function(t){console.log(t),console.log(this.showWhich),console.log(this.fileList[this.showWhich]);var e=this.getStandard(this.fileList[this.showWhich].data.length);console.log(e);var a={l:t["姓名"],xy:t["学业分排名"],sx:t["思想分排名"],wt:t["文体分排名"],zh:t["综合分专业年级排名"]};e.unshift(a),this.gridData=e},chooseGooodStu:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this;if(t){var a=this.chooseGood_one();if(-1===a.code)return this.showTableData=a.result,this.showSelect=!0,this.$message({showClose:!0,message:"三好学生标兵符合人数大于应评人数,请手动选择",type:"warning",duration:5e3}),void console.log(a)}for(var i=this.fileList,l=0;l<i.length;l++)for(var s=i[l].data.length,o=0;o<s;o++){var n=e.is_good_student(i[l].data[o],s);switch(n){case 120:if(i[l].good_student>0){i[l].data[o]["评优类别"]="三好学生",i[l].good_student--;break}if(i[l].good_student<=0&&i[l].good_activate>0){i[l].data[o]["评优类别"]="优秀学生干部",i[l].good_activate--;break}break;case 121:if(i[l].good_student>0){i[l].data[o]["评优类别"]="三好学生",i[l].good_student--;break}if(i[l].good_student<=0&&i[l].good_activate>0){i[l].data[o]["评优类别"]="学习积极分子",i[l].good_activate--;break}break;case 122:if(i[l].good_student>0){i[l].data[o]["评优类别"]="三好学生",i[l].good_student--;break}if(i[l].good_student<=0&&i[l].good_activate>0){i[l].data[o]["评优类别"]="文体积极分子",i[l].good_activate--;break}break;case 1:i[l].good_student>0&&(i[l].data[o]["评优类别"]="三好学生",i[l].good_student--);break;case 20:i[l].good_activate>0&&(i[l].data[o]["评优类别"]="优秀学生干部",i[l].good_activate--);break;case 21:i[l].good_activate>0&&(i[l].data[o]["评优类别"]="学习积极分子",i[l].good_activate--);break;case 22:i[l].good_activate>0&&(i[l].data[o]["评优类别"]="文体积极分子",i[l].good_activate--);break;default:break}}this.fileList=i,this.$message({showClose:!0,message:"评选完成",type:"success"})},formatter:function(t,e){return console.log(t,e),t.$index},indexMethod:function(t){return t+1},showWhat:function(t){switch(console.log(t),t){case 1:this.showTableData=this.tableData;break;case 2:this.showTableData=this.tableData.filter(function(t){return"三好学生标兵"===t["评优类别"]||"三好学生"===t["评优类别"]||"学习积极分子"===t["评优类别"]||"文体积极分子"===t["评优类别"]||"优秀学生干部"===t["评优类别"]});break;case 3:this.showTableData=this.tableData.filter(function(t){return"三好学生"===t["评优类别"]});break;case 4:this.showTableData=this.tableData.filter(function(t){return"学习积极分子"===t["评优类别"]||"文体积极分子"===t["评优类别"]||"优秀学生干部"===t["评优类别"]});break;case 5:this.showTableData=this.tableData.filter(function(t){return"优秀学生干部"===t["评优类别"]});break;case 6:this.showTableData=this.tableData.filter(function(t){return"学习积极分子"===t["评优类别"]});break;case 7:this.showTableData=this.tableData.filter(function(t){return"文体积极分子"===t["评优类别"]});break;case 8:var e=this.fileList;console.log(e);for(var a=[],i=0;i<e.length;i++)for(var l=0;l<e[i].data.length;l++)"三好学生标兵"===e[i].data[l]["评优类别"]&&a.push(e[i].data[l]);console.log(a),this.showTableData=a;break;default:break}},handleSearch:function(){console.log("S")},handleSelectionChange:function(t){if(this.showSelect){var e=t.map(function(t){return t["学号"]});console.log(e),this.multipleSelection=e}},makeSure:function(){var t=this.multipleSelection;if(t.length==this.good_student_bb){this.showSelect=!1;var e=this.fileList;console.log(t);for(var a=0;a<e.length;a++)for(var i=e[a].data.length,l=0;l<i;l++)t.includes(e[a].data[l]["学号"])&&this.good_student_bb>0&&(e[a].data[l]["评优类别"]="三好学生标兵",console.log(e[a].data[l]),this.good_student_bb--);this.fileList=e,this.tableData=this.fileList[0].data,this.showTableData=this.fileList[0].data,this.chooseGooodStu(!1)}else this.$message({showClose:!0,message:"需选择"+this.good_student_bb+"人",type:"warning"})},tableRowClassName:function(t){t.row;var e=t.rowIndex;return 0===e?"warning-row":""},handleSelect:function(t,e){console.log(t,e)}},data:function(){return{gridData:[],allStuNum:0,good_student_bb:0,showWhich:void 0,showTableData:[],tableData:[],activeNames:[],resultList:[],multipleSelection:[],showSelect:!1,count:10,loading:!1,activeIndex:"1",activeIndex2:"1",fileList:[],search:void 0,showTable:!1,filename:"附件1：各年级专业综测汇总表.xlsx"}}},E=y,k=(a("ff81"),Object(r["a"])(E,w,x,!1,null,"d850a130",null)),C=k.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-collapse",{on:{change:t.handleChange},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"综测结果评判使用说明",name:"1"}},[a("div",[a("li",[t._v("收齐各班的综测文件后 进入 合并Excel&排序")]),a("li",[t._v("按照专业年级进行 合并Excel&排序")]),a("li",[t._v("上一步完成后 进入 综合测评自动评判")]),a("li",[t._v("将前面导出的Excel文件导入到 综合测评自动评判 中")]),a("li",[t._v("点击 一键评测 导出评选结果Excel")]),a("li",[t._v("导出的Excel原样式丢失 可重新进行格式刷")])])]),a("el-collapse-item",{attrs:{title:"注意事项",name:"2"}},[a("div",[a("li",[t._v('挂科不予评选：当 是否挂科 一栏值为"是" 时判断该同学有挂科，不参与综测评优（是否挂科一栏需手动添加）')]),a("li",[t._v("排序规则：如有第五名和第六名成绩相等时，则有两个第五名（没有第六名）下一名显示第七名")])])]),a("el-collapse-item",{attrs:{title:"示例文件",name:"3"}},[a("div",[a("div",[t._v("导入数据1")]),a("a",{attrs:{href:"http://imgs.91ans.com/%E6%B5%8B%E8%AF%95020%E7%8F%AD%E7%BB%BC%E6%B5%8B%E6%B1%87%E6%80%BB%E8%A1%A8.xlsx"}},[t._v("测试020班综测汇总表.xlsx")]),a("div",[t._v("导入数据2")]),a("a",{attrs:{href:"http://imgs.91ans.com/%E6%B5%8B%E8%AF%95021%E7%8F%AD%E7%BB%BC%E6%B5%8B%E6%B1%87%E6%80%BB%E8%A1%A8.xlsx"}},[t._v("测试021班综测汇总表.xlsx")]),a("div",[t._v("合并Excel&排序后导出的文件示例")]),a("a",{attrs:{href:"http://imgs.91ans.com/%E6%B5%8B%E8%AF%9502%E7%BA%A7%E7%BB%BC%E6%B5%8B%E6%B1%87%E6%80%BB%E8%A1%A8.xlsx"}},[t._v("测试021级综测汇总表.xlsx")]),a("div",[t._v("综合测评自动评判后导出的文件示例")]),a("a",{attrs:{href:"http://imgs.91ans.com/%E9%99%84%E4%BB%B61%EF%BC%9A%E5%90%84%E5%B9%B4%E7%BA%A7%E4%B8%93%E4%B8%9A%E7%BB%BC%E6%B5%8B%E6%B1%87%E6%80%BB%E8%A1%A8.xlsx"}},[t._v("附件1：各年级专业综测汇总表.xlsx")])])])],1)],1)},S=[],L={created:function(){console.log("Create")},methods:{handleChange:function(t){console.log(t)}},data:function(){return{valueGK:[],activeNames:["1"]}}},D=L,A=(a("e546"),Object(r["a"])(D,B,S,!1,null,"a647c2cc",null)),z=A.exports,F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wscn-http404-container"},[a("div",{staticClass:"wscn-http404"},[a("div",{staticClass:"pic-404"}),a("div",{staticClass:"bullshit"},[a("div",{staticClass:"bullshit__oops"},[t._v("Page not found!")]),a("div",{staticClass:"bullshit__headline"},[t._v(t._s(t.message))]),a("div",{staticClass:"bullshit__info"},[t._v("请检查您输入的网址是否正确")]),a("router-link",{staticClass:"bullshit__return-home",attrs:{to:"/"}},[t._v("返回首页")])],1)])])},W=[],M={name:"Page404",computed:{message:function(){return"输入的网址有误"}}},j=M,T=(a("663a"),Object(r["a"])(j,F,W,!1,null,"71c81976",null)),O=T.exports;i["default"].use(d["a"]);var N=new d["a"]({mode:"history",base:"/zhku_eva/",routes:[{path:"/",component:z},{path:"/s",component:C},{path:"/m",component:_},{path:"*",component:O}]}),$=N,I=a("5c96"),R=a.n(I);a("0fae");i["default"].use(R.a),i["default"].config.productionTip=!1,new i["default"]({router:$,render:function(t){return t(h)}}).$mount("#app")},"5eaf":function(t,e,a){},"64a9":function(t,e,a){},"663a":function(t,e,a){"use strict";var i=a("5eaf"),l=a.n(i);l.a},c12c:function(t,e,a){},c545:function(t,e,a){},e546:function(t,e,a){"use strict";var i=a("19f7"),l=a.n(i);l.a},ff81:function(t,e,a){"use strict";var i=a("c12c"),l=a.n(i);l.a}});
//# sourceMappingURL=app.73ab519e.js.map